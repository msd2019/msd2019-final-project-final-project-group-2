# Plot the second plot and draw the axis on the right
par(new = TRUE)
plot(perc_civil_war$year, perc_civil_war$perc, pch = "solid", xlab = "", ylab = "", ylim = c(0, 30), axes = FALSE, type = "l", lty = 2, col = "red")
mtext("% Countries with a Civil War", side = 4, col = "black", line = 2.5)
axis(4, ylim = c(0, 30), col = "black", col.axis = "black")
# Draw the time axis
axis(1, pretty(range(perc_civil_war$year), 4))
mtext("Year", side = 1, col = "black", line = 2.5)
# Draw the legend
legend("topleft", legend = c("# civil wars", "% with civil war"),
text.col = c("blue", "red"), col = c("blue", "red"), lty = 1:2, cex = 0.7)
gdp_per_year <- repdata %>%
drop_na(gdpen) %>%
drop_na(pop) %>%
group_by(year) %>%
summarize(
gdp_sum = sum(gdpen),
pop_sum = sum(pop)
)
gdp_per_year$gdp_pc <- gdp_per_year$gdp_sum / gdp_per_year$pop_sum * 10000
gdp_per_year_perc <- merge(gdp_per_year, perc_civil_war, by = "year")
gdp_per_year_perc$cv_percentile <- round(gdp_per_year_perc$perc / max(gdp_per_year_perc$perc), digits = 4)
View(gdp_per_year_perc)
gdp_per_year_perc %>%
ggplot(aes(x = perc, y = gdp_pc)) +
geom_line(color = "red")
rep_data_eth <- repdata %>%
select(ethfrac, war) %>%
mutate(ethfrac_rounded = round(ethfrac, digits = 1)) %>%
group_by(ethfrac_rounded) %>%
summarize(
sum_countries = sum(n()),
sumwars_per_eth = sum(war)
)
rep_data_eth$war_perc = rep_data_eth$sumwars_per_eth/rep_data_eth$sum_countries
# View(rep_data_eth)
rep_data_eth %>%
ggplot(aes(x = war_perc, y = ethfrac_rounded)) +
geom_line(color = "blue")
mylogit <- glm(as.factor(onset) ~ warl + gdpenl + lpopl1 + lmtnest
+ ncontig + Oil + nwstate + instab + polity2l + ethfrac + relfrac,  data =repdata, family = "binomial")
summary(mylogit)
sumwars_per_year <- repdata %>% group_by(year) %>% filter(war == 1) %>%summarize(count_wars_total = sum(wars))
wars_per_year <- repdata %>% group_by(year) %>%filter(war == 1) %>%summarize(count_wars = sum(war))
raw_num_countries <- repdata %>% group_by(year) %>% summarize(count_countries = sum(n())) %>%ungroup(year)
perc_civil_war <- merge(wars_per_year, raw_num_countries, by = "year")
perc_civil_war <- merge(perc_civil_war, sumwars_per_year, by = "year")
#perc_civil_war$perc <- (perc_civil_war$count_wars/perc_civil_war$count_countries)*100
southamerica <- repdata  %>%
filter (lamerica == 1)
wars_per_year_SA <- southamerica %>% group_by(year) %>%
summarize(count_wars = sum(war))
percent_SA <- (wars_per_year_SA$count_wars/perc_civil_war$count_wars)
plot(wars_per_year_SA$year, percent_SA, axes = FALSE,
ylim = c(0, 1), xlim = c(1945, 2000), xlab = "" , ylab = "", type = "l",
col = "purple", main = "% of Civil Wars by Continent (1945-1999)")
western <- repdata %>% filter (western == 1)
wars_per_year_WS <- western %>% group_by(year)  %>% summarize(count_wars = sum(war))
percent_WS <- (wars_per_year_WS$count_wars/perc_civil_war$count_wars)
lines(wars_per_year_WS$year, percent_WS, col = "green")
easteurope <- repdata  %>% filter (eeurop == 1)
wars_per_year_EE <- easteurope %>% group_by(year)  %>% summarize(count_wars = sum(war))
percent_EE <- (wars_per_year_SA$count_wars/perc_civil_war$count_wars)
lines(wars_per_year_EE$year, percent_EE, col = "coral")
southafrica <- repdata  %>% filter (ssafrica == 1)
wars_per_year_SAF <- southafrica%>% group_by(year)  %>% summarize(count_wars = sum(war))
percent_SAF <- (wars_per_year_SAF$count_wars/perc_civil_war$count_wars)
lines(wars_per_year_SAF$year, percent_SAF, col = "blue")
asia <- repdata  %>% filter (asia == 1)
wars_per_year_AS <- asia %>% group_by(year)  %>% summarize(count_wars = sum(war))
percent_AS <- (wars_per_year_AS$count_wars/perc_civil_war$count_wars)
lines(wars_per_year_AS$year, percent_AS, col = "red")
northafricamiddleeast <- repdata %>% filter (nafrme == 1)
wars_per_year_NAM <- northafricamiddleeast %>% group_by(year)  %>% summarize(count_wars = sum(war))
percent_NAM <- (wars_per_year_NAM$count_wars/perc_civil_war$count_wars)
lines(wars_per_year_NAM$year, percent_NAM, col = "black")
#sumwars_per_year <- repdata %>% group_by(year) %>% filter(war == 1) %>% summarize(count_wars = sum(wars) )
#lines(sumwars_per_year$year, sumwars_per_year$count_wars, col = "darkgreen")
axis(2, ylim = c(0, 1), col = "black", las = 1)
axis(1, xlim = c(1945, 1999), col = "black", las = 1)
mtext("Percent ", side = 2, col = "black", line = 2.5)
mtext("Year", side = 1, col = "black", line = 2.5)
#legend("topleft", legend = c("South America", "North America & Western Europe", "Eastern Europe","South Africa", "Asia", "North Africa & Middle East", "Total # of Civil Wars" ),
#text.col = c("purple", "green", "coral", "blue", "red", "orange", "darkgreen"), col = c("purple", "green", "coral", "blue", "red", "orange", "darkgreen"), lty = 1:2, cex = 0.5)
legend("topright", legend = c("South America", "North America & Western Europe", "Eastern Europe","South Africa", "Asia", "North Africa & Middle East" ),
text.col = c("purple", "green", "coral", "blue", "red", "black"), col = c("purple", "green", "coral", "blue", "red", "black"), lty = 1:2, cex = 0.5)
repdata <- repdata %>% group_by(war) %>% mutate(outcome = ifelse(onset == 0 ,'civil_war','no_war'))
repdata$outcome <- as.factor(repdata$outcome)
# View(repdata)
set.seed(42)
ndx <- sample(nrow(repdata), floor(nrow(repdata) * 0.8))
train <- repdata[ndx,]
test <- repdata[-ndx,]
xTrain <- train[,-71]
repdata <- repdata %>% group_by(war) %>% mutate(outcome = ifelse(onset == 0 ,'civil_war','no_war'))
repdata$outcome <- as.factor(repdata$outcome)
# View(repdata)
set.seed(42)
ndx <- sample(nrow(repdata), floor(nrow(repdata) * 0.8))
train <- repdata[ndx,]
test <- repdata[-ndx,]
xTrain <- train[,-69]
yTrain <- train$outcome
xTest <- test[,-69]
yTest <- test$outcome
model <- naiveBayes(xTrain, yTrain)
install.packages("naivebayes")
library(naivebayes)
repdata <- repdata %>% group_by(war) %>% mutate(outcome = ifelse(onset == 0 ,'civil_war','no_war'))
repdata$outcome <- as.factor(repdata$outcome)
# View(repdata)
set.seed(42)
ndx <- sample(nrow(repdata), floor(nrow(repdata) * 0.8))
train <- repdata[ndx,]
test <- repdata[-ndx,]
xTrain <- train[,-69]
yTrain <- train$outcome
xTest <- test[,-69]
yTest <- test$outcome
model <- naiveBayes(xTrain, yTrain)
model <- naivebayes(xTrain, yTrain)
model <- naiveBayes(xTrain, yTrain)
model <- naive_bayes(xTrain, yTrain)
summary(model)
df <- data.frame(actual = yTest, pred = predict(model, xTest))
repdata <- repdata %>% group_by(war) %>% mutate(outcome = ifelse(onset == 0 ,'civil_war','no_war'))
repdata$outcome <- as.factor(repdata$outcome)
# View(repdata)
set.seed(42)
ndx <- sample(nrow(repdata), floor(nrow(repdata) * 0.8))
train <- repdata[ndx,]
test <- repdata[-ndx,]
xTrain <- train[,-69]
yTrain <- train$outcome
xTest <- test[,-69]
yTest <- test$outcome
model <- naive_bayes(xTrain, yTrain)
summary(model)
df <- data.frame(actual = yTest, pred = predict(model, xTest))
library(foreign)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(grid)
library(lubridate)
library(tidyr)
library(broom)
library(scales)
library(naivebayes)
library(ROCR)
library(pROC)
theme_set(theme_bw())
knitr::opts_chunk$set(echo = TRUE)
#Fearon and Laitin analyzed post-WWII global civil wars to see if they could create a model to predict the likelihood of civil war onset. They Investigated unique characteristics of the countries at hand to see if they could hypothesize which variable played the biggest role in the making of the civil war. Such as Poverty, political instability, ethnic and religious diversity.
# They defined Civil War by conflicts that meet three criteria: Involved fihgting between agents of a state and organized nonstate groups who sought to take control of a government policicies, the conflict killed at leas 1,000 over its course with at least an average of 100 yearly deaths, and the final criteria being that at least 100 were killed on both sides, including civilians attacked by rebels
#Created 11 hypthesis of the paper for their investgation, for example one was: Measures of country's ethnic or religious diversity should be associated with a higher risk of civil war. And most of the other followed suit but with different parameters in the hypothesis
#The paper concluded that there wasn't enough evidence to conclude that any of the hypothesis were on target and finished with saying that Civil Wars are incredible hard to predict, but it is easier to predict insurgencies.It includes a cast of doubt on three wide-held notions concerning political conflict findings: Prevalence of civil War in the 1990's was not due to the end of the Cold War, greater religious and/or ethnic diversity, on its own does not make a country more prone to civil war, and can't predict where a civil war will break out - based off of strong sthnic or political grievances
repdata <- read.dta("./data/repdata.dta")
glance(repdata)
View(repdata)
sumwars_per_year <- repdata %>%
group_by(year) %>%
filter(war == 1) %>%
summarize(
count_wars_total = sum(wars)
)
wars_per_year <- repdata %>%
group_by(year) %>%
filter(war == 1) %>%
summarize(
count_wars = sum(war)
)
raw_num_countries <- repdata %>%
group_by(year) %>%
summarize(
count_countries = sum(n())
) %>%
ungroup(year)
perc_civil_war <- merge(wars_per_year, raw_num_countries, by = "year")
perc_civil_war <- merge(perc_civil_war, sumwars_per_year, by = "year")
# View(perc_civil_war)
perc_civil_war$perc <- (perc_civil_war$count_wars/perc_civil_war$count_countries)*100
plot(perc_civil_war$year, perc_civil_war$count_wars_total, axes = FALSE,
ylim = c(0, 50), xlab = "", ylab = "", type = "l",
col = "blue", main = "# and % of Countries with Ongoing Civil Wars (1945-1999)")
axis(2, ylim = c(0, 50), col = "black", las = 1)
mtext("# Ongoing Wars", side = 2, col = "black", line = 2.5)
# Plot the second plot and draw the axis on the right
par(new = TRUE)
plot(perc_civil_war$year, perc_civil_war$perc, pch = "solid", xlab = "", ylab = "", ylim = c(0, 30), axes = FALSE, type = "l", lty = 2, col = "red")
mtext("% Countries with a Civil War", side = 4, col = "black", line = 2.5)
axis(4, ylim = c(0, 30), col = "black", col.axis = "black")
# Draw the time axis
axis(1, pretty(range(perc_civil_war$year), 4))
mtext("Year", side = 1, col = "black", line = 2.5)
# Draw the legend
legend("topleft", legend = c("# civil wars", "% with civil war"),
text.col = c("blue", "red"), col = c("blue", "red"), lty = 1:2, cex = 0.7)
gdp_per_year <- repdata %>%
drop_na(gdpen) %>%
drop_na(pop) %>%
group_by(year) %>%
summarize(
gdp_sum = sum(gdpen),
pop_sum = sum(pop)
)
gdp_per_year$gdp_pc <- gdp_per_year$gdp_sum / gdp_per_year$pop_sum * 10000
gdp_per_year_perc <- merge(gdp_per_year, perc_civil_war, by = "year")
gdp_per_year_perc$cv_percentile <- round(gdp_per_year_perc$perc / max(gdp_per_year_perc$perc), digits = 4)
#View(gdp_per_year_perc)
gdp_per_year_perc %>%
ggplot(aes(x = perc, y = gdp_pc)) +
geom_line(color = "red")
rep_data_eth <- repdata %>%
select(ethfrac, war) %>%
mutate(ethfrac_rounded = round(ethfrac, digits = 1)) %>%
group_by(ethfrac_rounded) %>%
summarize(
sum_countries = sum(n()),
sumwars_per_eth = sum(war)
)
rep_data_eth$war_perc = rep_data_eth$sumwars_per_eth/rep_data_eth$sum_countries
# View(rep_data_eth)
rep_data_eth %>%
ggplot(aes(x = war_perc, y = ethfrac_rounded)) +
geom_line(color = "blue")
mylogit <- glm(as.factor(onset) ~ warl + gdpenl + lpopl1 + lmtnest
+ ncontig + Oil + nwstate + instab + polity2l + ethfrac + relfrac,  data =repdata, family = "binomial")
summary(mylogit)
sumwars_per_year <- repdata %>% group_by(year) %>% filter(war == 1) %>%summarize(count_wars_total = sum(wars))
wars_per_year <- repdata %>% group_by(year) %>%filter(war == 1) %>%summarize(count_wars = sum(war))
raw_num_countries <- repdata %>% group_by(year) %>% summarize(count_countries = sum(n())) %>%ungroup(year)
perc_civil_war <- merge(wars_per_year, raw_num_countries, by = "year")
perc_civil_war <- merge(perc_civil_war, sumwars_per_year, by = "year")
#perc_civil_war$perc <- (perc_civil_war$count_wars/perc_civil_war$count_countries)*100
southamerica <- repdata  %>%
filter (lamerica == 1)
wars_per_year_SA <- southamerica %>% group_by(year) %>%
summarize(count_wars = sum(war))
percent_SA <- (wars_per_year_SA$count_wars/perc_civil_war$count_wars)
plot(wars_per_year_SA$year, percent_SA, axes = FALSE,
ylim = c(0, 1), xlim = c(1945, 2000), xlab = "" , ylab = "", type = "l",
col = "purple", main = "% of Civil Wars by Continent (1945-1999)")
western <- repdata %>% filter (western == 1)
wars_per_year_WS <- western %>% group_by(year)  %>% summarize(count_wars = sum(war))
percent_WS <- (wars_per_year_WS$count_wars/perc_civil_war$count_wars)
lines(wars_per_year_WS$year, percent_WS, col = "green")
easteurope <- repdata  %>% filter (eeurop == 1)
wars_per_year_EE <- easteurope %>% group_by(year)  %>% summarize(count_wars = sum(war))
percent_EE <- (wars_per_year_SA$count_wars/perc_civil_war$count_wars)
lines(wars_per_year_EE$year, percent_EE, col = "coral")
southafrica <- repdata  %>% filter (ssafrica == 1)
wars_per_year_SAF <- southafrica%>% group_by(year)  %>% summarize(count_wars = sum(war))
percent_SAF <- (wars_per_year_SAF$count_wars/perc_civil_war$count_wars)
lines(wars_per_year_SAF$year, percent_SAF, col = "blue")
asia <- repdata  %>% filter (asia == 1)
wars_per_year_AS <- asia %>% group_by(year)  %>% summarize(count_wars = sum(war))
percent_AS <- (wars_per_year_AS$count_wars/perc_civil_war$count_wars)
lines(wars_per_year_AS$year, percent_AS, col = "red")
northafricamiddleeast <- repdata %>% filter (nafrme == 1)
wars_per_year_NAM <- northafricamiddleeast %>% group_by(year)  %>% summarize(count_wars = sum(war))
percent_NAM <- (wars_per_year_NAM$count_wars/perc_civil_war$count_wars)
lines(wars_per_year_NAM$year, percent_NAM, col = "black")
#sumwars_per_year <- repdata %>% group_by(year) %>% filter(war == 1) %>% summarize(count_wars = sum(wars) )
#lines(sumwars_per_year$year, sumwars_per_year$count_wars, col = "darkgreen")
axis(2, ylim = c(0, 1), col = "black", las = 1)
axis(1, xlim = c(1945, 1999), col = "black", las = 1)
mtext("Percent ", side = 2, col = "black", line = 2.5)
mtext("Year", side = 1, col = "black", line = 2.5)
#legend("topleft", legend = c("South America", "North America & Western Europe", "Eastern Europe","South Africa", "Asia", "North Africa & Middle East", "Total # of Civil Wars" ),
#text.col = c("purple", "green", "coral", "blue", "red", "orange", "darkgreen"), col = c("purple", "green", "coral", "blue", "red", "orange", "darkgreen"), lty = 1:2, cex = 0.5)
legend("topright", legend = c("South America", "North America & Western Europe", "Eastern Europe","South Africa", "Asia", "North Africa & Middle East" ),
text.col = c("purple", "green", "coral", "blue", "red", "black"), col = c("purple", "green", "coral", "blue", "red", "black"), lty = 1:2, cex = 0.5)
View(repdata)
repdata <- repdata %>% group_by(war) %>% mutate(outcome = ifelse(onset == 0 ,'civil_war','no_war'))
repdata$outcome <- as.factor(repdata$outcome)
set.seed(42)
ndx <- sample(nrow(repdata), floor(nrow(repdata) * 0.8))
train <- repdata[ndx,]
test <- repdata[-ndx,]
xTrain <- train[,-69]
yTrain <- train$outcome
xTest <- test[,-69]
yTest <- test$outcome
View(xTrain)
View(repdata)
model <- naiveBayes(xTrain, yTrain)
repdata$outcome
repdata$outcome <- as.factor(repdata$outcome)
repdata$outcome
repdata <- repdata %>% group_by(war) %>% mutate(outcome = ifelse(onset == 0 ,1,0))
repdata$outcome <- as.factor(repdata$outcome)
set.seed(42)
ndx <- sample(nrow(repdata), floor(nrow(repdata) * 0.8))
train <- repdata[ndx,]
test <- repdata[-ndx,]
xTrain <- train[,-69]
yTrain <- train$outcome
xTest <- test[,-69]
yTest <- test$outcome
model <- naive_bayes(xTrain, yTrain)
summary(model)
df <- data.frame(actual = yTest, pred = predict(model, xTest))
library(foreign)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(grid)
library(lubridate)
library(tidyr)
library(broom)
library(scales)
library(naivebayes)
library(ROCR)
library(pROC)
theme_set(theme_bw())
knitr::opts_chunk$set(echo = TRUE)
repdata <- read.dta("./data/repdata.dta")
glance(repdata)
View(repdata)
sumwars_per_year <- repdata %>%
group_by(year) %>%
filter(war == 1) %>%
summarize(
count_wars_total = sum(wars)
)
wars_per_year <- repdata %>%
group_by(year) %>%
filter(war == 1) %>%
summarize(
count_wars = sum(war)
)
raw_num_countries <- repdata %>%
group_by(year) %>%
summarize(
count_countries = sum(n())
) %>%
ungroup(year)
perc_civil_war <- merge(wars_per_year, raw_num_countries, by = "year")
perc_civil_war <- merge(perc_civil_war, sumwars_per_year, by = "year")
# View(perc_civil_war)
perc_civil_war$perc <- (perc_civil_war$count_wars/perc_civil_war$count_countries)*100
plot(perc_civil_war$year, perc_civil_war$count_wars_total, axes = FALSE,
ylim = c(0, 50), xlab = "", ylab = "", type = "l",
col = "blue", main = "# and % of Countries with Ongoing Civil Wars (1945-1999)")
axis(2, ylim = c(0, 50), col = "black", las = 1)
mtext("# Ongoing Wars", side = 2, col = "black", line = 2.5)
# Plot the second plot and draw the axis on the right
par(new = TRUE)
plot(perc_civil_war$year, perc_civil_war$perc, pch = "solid", xlab = "", ylab = "", ylim = c(0, 30), axes = FALSE, type = "l", lty = 2, col = "red")
mtext("% Countries with a Civil War", side = 4, col = "black", line = 2.5)
axis(4, ylim = c(0, 30), col = "black", col.axis = "black")
# Draw the time axis
axis(1, pretty(range(perc_civil_war$year), 4))
mtext("Year", side = 1, col = "black", line = 2.5)
# Draw the legend
legend("topleft", legend = c("# civil wars", "% with civil war"),
text.col = c("blue", "red"), col = c("blue", "red"), lty = 1:2, cex = 0.7)
gdp_per_year <- repdata %>%
drop_na(gdpen) %>%
drop_na(pop) %>%
group_by(year) %>%
summarize(
gdp_sum = sum(gdpen),
pop_sum = sum(pop)
)
gdp_per_year$gdp_pc <- gdp_per_year$gdp_sum / gdp_per_year$pop_sum * 10000
gdp_per_year_perc <- merge(gdp_per_year, perc_civil_war, by = "year")
gdp_per_year_perc$cv_percentile <- round(gdp_per_year_perc$perc / max(gdp_per_year_perc$perc), digits = 4)
#View(gdp_per_year_perc)
gdp_per_year_perc %>%
ggplot(aes(x = perc, y = gdp_pc)) +
geom_line(color = "red")
rep_data_eth <- repdata %>%
select(ethfrac, war) %>%
mutate(ethfrac_rounded = round(ethfrac, digits = 1)) %>%
group_by(ethfrac_rounded) %>%
summarize(
sum_countries = sum(n()),
sumwars_per_eth = sum(war)
)
rep_data_eth$war_perc = rep_data_eth$sumwars_per_eth/rep_data_eth$sum_countries
# View(rep_data_eth)
rep_data_eth %>%
ggplot(aes(x = war_perc, y = ethfrac_rounded)) +
geom_line(color = "blue")
mylogit <- glm(as.factor(onset) ~ warl + gdpenl + lpopl1 + lmtnest
+ ncontig + Oil + nwstate + instab + polity2l + ethfrac + relfrac,  data =repdata, family = "binomial")
summary(mylogit)
set.seed(42)
ndx <- sample(nrow(repdata), floor(nrow(repdata) * 0.8))
train <- repdata[ndx,]
test <- repdata[-ndx,]
mylogit_train <- glm(as.factor(onset) ~ warl + gdpenl + lpopl1 + lmtnest
+ ncontig + Oil + nwstate + instab + polity2l + ethfrac + relfrac,  data =train, family = "binomial")
actual_y <- as.factor(test$onset)
df <- data.frame(pred = predict(model, test))
pred = predict(model, test)
pred = predict(mylogit_train, test)
df <- data.frame(actual = actual_y, pred )
head(df)
table(df)
cv.glm(test,mylogit_train, K=10)
actual_y <- as.factor(test$onset)
pred = predict(mylogit_train, test)
df <- data.frame(actual = actual_y, pred )
head(df)
table(df)
df %>%
summarize(acc = mean(pred == actual_y))
df %>%
filter(pred == 'civil_war') %>%
summarize(prec = mean(actual == 'civil_war'))
df %>%
filter(actual == 'civil_war') %>%
summarize(recall = mean(pred == 'civil_war'))
df %>%
filter(actual == 'no_war') %>%
summarize(fpr = mean(pred == 'civil_war'))
probs <- data.frame(predict(model, test, type="raw"))
probs <- data.frame(predict(mylogit_train, test, type="raw"))
probs <- data.frame(predict(mylogit_train, test))
ggplot(probs, aes(x = civil_war)) +
geom_histogram(binwidth = 0.01) +
scale_x_continuous(label = percent) +
xlab('Predicted probability of civil war') +
ylab('Number of examples')
ggplot(probs, aes(x = onset)) +
geom_histogram(binwidth = 0.01) +
scale_x_continuous(label = percent) +
xlab('Predicted probability of civil war') +
ylab('Number of examples')
View(probs)
ggplot(probs, aes(x = predict.mylogit_train..test.)) +
geom_histogram(binwidth = 0.01) +
scale_x_continuous(label = percent) +
xlab('Predicted probability of civil war') +
ylab('Number of examples')
data.frame(predicted=probs[, predict.mylogit_train..test.], actual=actual_y) %>%
group_by(predicted=round(predicted*10)/10) %>%
summarize(num=n(), actual=mean(actual == predict.mylogit_train..test.)) %>%
ggplot(data=., aes(x=predicted, y=actual, size=num)) +
geom_point() +
geom_abline(linetype=2) +
scale_x_continuous(labels=percent, lim=c(0,1)) +
scale_y_continuous(labels=percent, lim=c(0,1)) +
xlab('Predicted probability of civil war') +
ylab('Percent that are actually civil war')
data.frame(predicted=probs[, "predict.mylogit_train..test."], actual=actual_y) %>%
group_by(predicted=round(predicted*10)/10) %>%
summarize(num=n(), actual=mean(actual == "predict.mylogit_train..test.")) %>%
ggplot(data=., aes(x=predicted, y=actual, size=num)) +
geom_point() +
geom_abline(linetype=2) +
scale_x_continuous(labels=percent, lim=c(0,1)) +
scale_y_continuous(labels=percent, lim=c(0,1)) +
xlab('Predicted probability of civil war') +
ylab('Percent that are actually civil war')
pred <- prediction(probs[, "predict.mylogit_train..test."], actual_y)
set.seed(42)
ndx <- sample(nrow(repdata), floor(nrow(repdata) * 0.8))
train <- repdata[ndx,]
test <- repdata[-ndx,]
mylogit_train <- glm(as.factor(onset) ~ warl + gdpenl + lpopl1 + lmtnest
+ ncontig + Oil + nwstate + instab + polity2l + ethfrac + relfrac,  data =train, family = "binomial")
actual_y <- as.factor(test$onset)
pred = predict(mylogit_train, test)
df <- data.frame(actual = actual_y, pred )
head(df)
table(df)
df %>%
summarize(acc = mean(pred == actual_y))
# precision: fraction of positive predictions that are actually true
df %>%
filter(pred == 'civil_war') %>%
summarize(prec = mean(actual == 'civil_war'))
# recall: fraction of true examples that we predicted to be positive
# aka true positive rate, sensitivity
df %>%
filter(actual == 'civil_war') %>%
summarize(recall = mean(pred == 'civil_war'))
# false positive rate: fraction of false examples that we predicted to be positive
df %>%
filter(actual == 'no_war') %>%
summarize(fpr = mean(pred == 'civil_war'))
# plot histogram of predicted probabilities
# note overconfident predictions
probs <- data.frame(predict(mylogit_train, test))
ggplot(probs, aes(x = predict.mylogit_train..test.)) +
geom_histogram(binwidth = 0.01) +
scale_x_continuous(label = percent) +
xlab('Predicted probability of civil war') +
ylab('Number of examples')
data.frame(predicted=probs[, "predict.mylogit_train..test."], actual=actual_y) %>%
group_by(predicted=round(predicted*10)/10) %>%
summarize(num=n(), actual=mean(actual == "predict.mylogit_train..test.")) %>%
ggplot(data=., aes(x=predicted, y=actual, size=num)) +
geom_point() +
geom_abline(linetype=2) +
scale_x_continuous(labels=percent, lim=c(0,1)) +
scale_y_continuous(labels=percent, lim=c(0,1)) +
xlab('Predicted probability of civil war') +
ylab('Percent that are actually civil war')
# create a ROCR object
pred <- prediction(probs[, "predict.mylogit_train..test."], actual_y)
sessionInfo()
mylogit1 <- glm(as.factor(onset) ~ warl + gdpenl + lpopl1 + lmtnest
+ ncontig + Oil + nwstate + instab + polity2l + ethfrac + relfrac,  data =repdata, family = "binomial")
summary(mylogit1)
mylogit2 <-glm(as.factor(onset) ~gdpenl + lpopl1 + lmtnest
+ ncontig + Oil + nwstate + instab + polity2l + ethfrac + relfrac,  data =repdata, family = "binomial")
summary(mylogit2)
